{
  "openapi": "3.1.0",
  "info": {
    "title": "UAM Relay",
    "version": "0.1.0"
  },
  "paths": {
    "/api/v1/register": {
      "post": {
        "summary": "Register",
        "description": "Register a new agent with the relay.\n\nThis is the only public (unauthenticated) endpoint besides /health.\nRate limited to 5 registrations per minute per IP.",
        "operationId": "register_api_v1_register_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegisterResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/{address}/public-key": {
      "get": {
        "summary": "Get Public Key",
        "description": "Return the public key for a registered agent.\n\nUnauthenticated -- any caller can look up any agent's public key.\nThis is required for encrypting the first message (handshake.request)\nwhen the sender has no prior relationship with the recipient.",
        "operationId": "get_public_key_api_v1_agents__address__public_key_get",
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PublicKeyResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/{address}": {
      "patch": {
        "summary": "Patch Agent",
        "description": "Update agent fields (display_name, contact_card, public_key).\n\nRequires Bearer token auth.  Agent can only update their own record.\nIf ``public_key`` is provided, it must be a valid Ed25519 key.",
        "operationId": "patch_agent_api_v1_agents__address__patch",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAgentRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete Agent",
        "description": "Soft-deactivate an agent.\n\nRequires Bearer token auth.  Agent can only deactivate themselves.",
        "operationId": "delete_agent_api_v1_agents__address__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Delete Agent Api V1 Agents  Address  Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/{address}/reactivate": {
      "post": {
        "summary": "Reactivate Agent Endpoint",
        "description": "Reactivate a soft-deleted agent.\n\nRequires Bearer token auth.  The token must match the original agent's\ntoken (auth does not filter by deleted_at so soft-deleted agents can\nstill authenticate for reactivation).",
        "operationId": "reactivate_agent_endpoint_api_v1_agents__address__reactivate_post",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/send": {
      "post": {
        "summary": "Send Message",
        "description": "Send a signed message envelope via REST.\n\nOrder of operations (DoS-resistant):\n1.  Auth (via dependency injection -- already done)\n2.  Blocklist check (SPAM-01 -- O(1) set lookup)\n3.  Allowlist check (SPAM-01 -- O(1), sets skip_reputation flag)\n4.  Adaptive sender rate limit (SPAM-04 -- reputation-based limit)\n5.  Parse envelope\n6.  Sender identity match\n7.  Domain rate limit (SPAM-03 -- relay domain exempt)\n8.  Recipient rate limit (RELAY-05)\n9.  Reputation score check (SPAM-06 -- drop if score <20)\n10. Signature verification (expensive -- LAST)\n11. Route or store",
        "operationId": "send_message_api_v1_send_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SendRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SendResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/inbox/{address}": {
      "get": {
        "summary": "Get Inbox",
        "description": "Retrieve stored messages for an agent.\n\nBearer token auth via ``verify_token_http`` dependency.\nAgent can only read their own inbox.",
        "operationId": "get_inbox_api_v1_inbox__address__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "default": 50,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InboxResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/messages/thread/{thread_id}": {
      "get": {
        "summary": "Get Thread Messages",
        "description": "Retrieve messages in a thread.\n\nRequires Bearer token auth.  The authenticated agent must be a\nparticipant (from_addr or to_addr) in at least one message in the\nthread.  Returns 403 if not a participant or if thread is empty.",
        "operationId": "get_thread_messages_api_v1_messages_thread__thread_id__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "thread_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Thread Id"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "default": 100,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ThreadResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/messages/{message_id}/receipt": {
      "post": {
        "summary": "Submit Receipt",
        "description": "Submit a receipt (e.g. ``receipt.read``) for a received message.\n\nRequires Bearer token auth.  The authenticated agent must be the\nrecipient of the message.  Routes the receipt envelope to the\noriginal sender via the connection manager.",
        "operationId": "submit_receipt_api_v1_messages__message_id__receipt_post",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "message_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Message Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReceiptRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReceiptResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/federation/deliver": {
      "post": {
        "summary": "Federation Deliver",
        "description": "Accept an inbound federated envelope from a remote relay.\n\nValidation order (DoS-resistant, cheapest checks first):\n1.  Federation enabled check\n2.  Parse request fields\n3.  Timestamp freshness\n4.  Loop prevention (hop_count + via chain)\n5.  Destination domain verification\n6.  Relay signature verification (with key rotation retry)\n7.  Agent envelope signature verification\n8.  Dedup check\n9.  Deliver (WebSocket > webhook > store)\n10. Log to federation_log",
        "operationId": "federation_deliver_api_v1_federation_deliver_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/FederationDeliverRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FederationDeliverResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/demo/session": {
      "post": {
        "summary": "Create Demo Session",
        "description": "Create an ephemeral demo agent with a real Ed25519 keypair.\n\nThe keypair is held server-side; the browser only receives a session\ntoken and the agent address.",
        "operationId": "create_demo_session_api_v1_demo_session_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateSessionResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/demo/send": {
      "post": {
        "summary": "Demo Send",
        "description": "Send a message from the demo session to any registered agent.\n\nThe relay signs and encrypts the envelope on behalf of the ephemeral\nagent using the server-held private key.",
        "operationId": "demo_send_api_v1_demo_send_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DemoSendRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DemoSendResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/demo/inbox": {
      "get": {
        "summary": "Demo Inbox",
        "description": "Return decrypted plaintext messages for the demo session.\n\nThe relay decrypts each stored envelope using the server-held private\nkey, so the browser receives plaintext content.",
        "operationId": "demo_inbox_api_v1_demo_inbox_get",
        "parameters": [
          {
            "name": "session_id",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Demo session ID",
              "title": "Session Id"
            },
            "description": "Demo session ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DemoInboxResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/verify-domain": {
      "post": {
        "summary": "Verify Domain",
        "description": "Verify domain ownership for Tier 2 status (DNS-04).\n\nRequires Bearer token authentication.  The relay independently\nverifies that the agent's public key appears in the domain's DNS\nTXT record or HTTPS ``.well-known/uam.json`` file.",
        "operationId": "verify_domain_api_v1_verify_domain_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyDomainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VerifyDomainResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/agents/{address}/verification": {
      "get": {
        "summary": "Get Verification Status",
        "description": "Return verification status for an agent (public, no auth required).\n\nReturns ``{\"address\": ..., \"tier\": 1|2, \"domain\": ...}``\nor 404 if the agent is not registered.",
        "operationId": "get_verification_status_api_v1_agents__address__verification_get",
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Verification Status Api V1 Agents  Address  Verification Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/{address}/webhook": {
      "put": {
        "summary": "Set Webhook Url",
        "description": "Set or update the webhook URL for an agent (HOOK-01).",
        "operationId": "set_webhook_url_api_v1_agents__address__webhook_put",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookUrlRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookUrlResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete Webhook Url",
        "description": "Remove the webhook URL for an agent.",
        "operationId": "delete_webhook_url_api_v1_agents__address__webhook_delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookUrlResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Get Webhook Url",
        "description": "Get the current webhook URL for an agent.",
        "operationId": "get_webhook_url_api_v1_agents__address__webhook_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookUrlResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/{address}/webhook/deliveries": {
      "get": {
        "summary": "List Webhook Deliveries",
        "description": "Get recent webhook delivery records for an agent (HOOK-06).",
        "operationId": "list_webhook_deliveries_api_v1_agents__address__webhook_deliveries_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "default": 50,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookDeliveryListResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/blocklist": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "List Blocked",
        "description": "List all blocklist entries.",
        "operationId": "list_blocked_api_v1_admin_blocklist_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BlocklistListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Add Blocked",
        "description": "Add a pattern to the blocklist.",
        "operationId": "add_blocked_api_v1_admin_blocklist_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BlocklistRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Add Blocked Api V1 Admin Blocklist Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/blocklist/{pattern}": {
      "delete": {
        "tags": [
          "admin"
        ],
        "summary": "Remove Blocked",
        "description": "Remove a pattern from the blocklist.",
        "operationId": "remove_blocked_api_v1_admin_blocklist__pattern__delete",
        "parameters": [
          {
            "name": "pattern",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Pattern"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Remove Blocked Api V1 Admin Blocklist  Pattern  Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/allowlist": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "List Allowed",
        "description": "List all allowlist entries.",
        "operationId": "list_allowed_api_v1_admin_allowlist_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AllowlistListResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Add Allowed",
        "description": "Add a pattern to the allowlist.",
        "operationId": "add_allowed_api_v1_admin_allowlist_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AllowlistRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Add Allowed Api V1 Admin Allowlist Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/allowlist/{pattern}": {
      "delete": {
        "tags": [
          "admin"
        ],
        "summary": "Remove Allowed",
        "description": "Remove a pattern from the allowlist.",
        "operationId": "remove_allowed_api_v1_admin_allowlist__pattern__delete",
        "parameters": [
          {
            "name": "pattern",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Pattern"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Remove Allowed Api V1 Admin Allowlist  Pattern  Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/reputation/{address}": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Reputation",
        "description": "Inspect agent reputation.",
        "operationId": "get_reputation_api_v1_admin_reputation__address__get",
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReputationResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin"
        ],
        "summary": "Set Reputation",
        "description": "Admin override of reputation score.",
        "operationId": "set_reputation_api_v1_admin_reputation__address__put",
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetReputationRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReputationResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/agents": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Admin List Agents",
        "description": "List all agents (including soft-deleted) for admin inspection.",
        "operationId": "admin_list_agents_api_v1_admin_agents_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "default": 100,
              "title": "Limit"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0,
              "title": "Offset"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminAgentListResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/agents/{address}/suspend": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Suspend Agent",
        "description": "Suspend an agent (admin action).",
        "operationId": "admin_suspend_agent_api_v1_admin_agents__address__suspend_post",
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminAgentResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/audit": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Audit Log",
        "description": "Query the audit log with optional filters.",
        "operationId": "admin_audit_log_api_v1_admin_audit_get",
        "parameters": [
          {
            "name": "action",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Action"
            }
          },
          {
            "name": "entity_type",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Entity Type"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "default": 100,
              "title": "Limit"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "default": 0,
              "title": "Offset"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuditLogResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/messages/expired": {
      "delete": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Purge Expired Messages",
        "description": "Purge expired and old delivered/soft-deleted messages.",
        "operationId": "admin_purge_expired_messages_api_v1_admin_messages_expired_delete",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PurgeExpiredResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/agents/{address}/presence": {
      "get": {
        "summary": "Get Presence",
        "description": "Check whether an agent is currently online.\n\nReturns the agent's online status (based on active WebSocket connection)\nand their last_seen timestamp from the database.\n\nRequires Bearer token authentication.",
        "operationId": "get_presence_api_v1_agents__address__presence_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PresenceResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/handshakes/send": {
      "post": {
        "tags": [
          "handshakes"
        ],
        "summary": "Send Handshake",
        "description": "Initiate a relay-mediated handshake with another agent.\n\nCreates a pending handshake request from the authenticated agent\nto the target address.  Optionally includes a contact card.",
        "operationId": "send_handshake_api_v1_handshakes_send_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HandshakeSendRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HandshakeResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/handshakes/pending/{address}": {
      "get": {
        "tags": [
          "handshakes"
        ],
        "summary": "List Pending Handshakes",
        "description": "List pending handshakes for the authenticated agent.\n\nAgent can only view their own pending handshakes (incoming).",
        "operationId": "list_pending_handshakes_api_v1_handshakes_pending__address__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "address",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Address"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HandshakeListResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/handshakes/{handshake_id}/respond": {
      "post": {
        "tags": [
          "handshakes"
        ],
        "summary": "Respond To Handshake",
        "description": "Respond to a pending handshake (approve or deny).\n\nThe authenticated agent must be the ``to_addr`` of the handshake.",
        "operationId": "respond_to_handshake_api_v1_handshakes__handshake_id__respond_post",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "handshake_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Handshake Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HandshakeRespondRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HandshakeResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health",
        "description": "Return relay status. No authentication required.",
        "operationId": "health_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/admin/health": {
      "get": {
        "summary": "Admin Health",
        "description": "Return comprehensive relay diagnostics. Requires admin key auth.",
        "operationId": "admin_health_admin_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminHealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/.well-known/uam-relay.json": {
      "get": {
        "summary": "Well Known Relay",
        "description": "Serve this relay's identity for federation discovery.",
        "operationId": "well_known_relay__well_known_uam_relay_json_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WellKnownRelayResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AdminAgentListResponse": {
        "properties": {
          "agents": {
            "items": {
              "$ref": "#/components/schemas/AdminAgentResponse"
            },
            "type": "array",
            "title": "Agents"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "agents",
          "count"
        ],
        "title": "AdminAgentListResponse"
      },
      "AdminAgentResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "public_key": {
            "type": "string",
            "title": "Public Key"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "display_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Display Name"
          },
          "webhook_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Webhook Url"
          },
          "last_seen": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Seen"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "title": "Updated At"
          },
          "deleted_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Deleted At"
          }
        },
        "type": "object",
        "required": [
          "address",
          "public_key",
          "status",
          "created_at",
          "updated_at"
        ],
        "title": "AdminAgentResponse"
      },
      "AdminHealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "db_ok": {
            "type": "boolean",
            "title": "Db Ok"
          },
          "queue_depth": {
            "type": "integer",
            "title": "Queue Depth"
          },
          "ws_connections": {
            "type": "integer",
            "title": "Ws Connections"
          },
          "uptime_seconds": {
            "type": "number",
            "title": "Uptime Seconds"
          },
          "migration_version": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Migration Version"
          }
        },
        "type": "object",
        "required": [
          "status",
          "db_ok",
          "queue_depth",
          "ws_connections",
          "uptime_seconds"
        ],
        "title": "AdminHealthResponse"
      },
      "AgentResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "public_key": {
            "type": "string",
            "title": "Public Key"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "display_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Display Name"
          },
          "webhook_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Webhook Url"
          },
          "last_seen": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Seen"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "address",
          "public_key",
          "status",
          "created_at"
        ],
        "title": "AgentResponse"
      },
      "AllowlistEntry": {
        "properties": {
          "id": {
            "type": "integer",
            "title": "Id"
          },
          "pattern": {
            "type": "string",
            "title": "Pattern"
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "pattern",
          "created_at"
        ],
        "title": "AllowlistEntry"
      },
      "AllowlistListResponse": {
        "properties": {
          "entries": {
            "items": {
              "$ref": "#/components/schemas/AllowlistEntry"
            },
            "type": "array",
            "title": "Entries"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "entries",
          "count"
        ],
        "title": "AllowlistListResponse"
      },
      "AllowlistRequest": {
        "properties": {
          "pattern": {
            "type": "string",
            "title": "Pattern"
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason"
          }
        },
        "type": "object",
        "required": [
          "pattern"
        ],
        "title": "AllowlistRequest"
      },
      "AuditLogEntry": {
        "properties": {
          "id": {
            "type": "integer",
            "title": "Id"
          },
          "action": {
            "type": "string",
            "title": "Action"
          },
          "entity_type": {
            "type": "string",
            "title": "Entity Type"
          },
          "entity_id": {
            "type": "string",
            "title": "Entity Id"
          },
          "actor_address": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Actor Address"
          },
          "timestamp": {
            "type": "string",
            "title": "Timestamp"
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details"
          },
          "ip_address": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Ip Address"
          }
        },
        "type": "object",
        "required": [
          "id",
          "action",
          "entity_type",
          "entity_id",
          "timestamp"
        ],
        "title": "AuditLogEntry"
      },
      "AuditLogResponse": {
        "properties": {
          "entries": {
            "items": {
              "$ref": "#/components/schemas/AuditLogEntry"
            },
            "type": "array",
            "title": "Entries"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "entries",
          "count"
        ],
        "title": "AuditLogResponse"
      },
      "BlocklistEntry": {
        "properties": {
          "id": {
            "type": "integer",
            "title": "Id"
          },
          "pattern": {
            "type": "string",
            "title": "Pattern"
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "pattern",
          "created_at"
        ],
        "title": "BlocklistEntry"
      },
      "BlocklistListResponse": {
        "properties": {
          "entries": {
            "items": {
              "$ref": "#/components/schemas/BlocklistEntry"
            },
            "type": "array",
            "title": "Entries"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "entries",
          "count"
        ],
        "title": "BlocklistListResponse"
      },
      "BlocklistRequest": {
        "properties": {
          "pattern": {
            "type": "string",
            "title": "Pattern"
          },
          "reason": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Reason"
          }
        },
        "type": "object",
        "required": [
          "pattern"
        ],
        "title": "BlocklistRequest"
      },
      "CreateSessionResponse": {
        "properties": {
          "session_id": {
            "type": "string",
            "title": "Session Id"
          },
          "address": {
            "type": "string",
            "title": "Address"
          }
        },
        "type": "object",
        "required": [
          "session_id",
          "address"
        ],
        "title": "CreateSessionResponse"
      },
      "DemoInboxResponse": {
        "properties": {
          "messages": {
            "items": {
              "$ref": "#/components/schemas/DemoMessage"
            },
            "type": "array",
            "title": "Messages"
          }
        },
        "type": "object",
        "required": [
          "messages"
        ],
        "title": "DemoInboxResponse"
      },
      "DemoMessage": {
        "properties": {
          "from_address": {
            "type": "string",
            "title": "From Address"
          },
          "content": {
            "type": "string",
            "title": "Content"
          },
          "timestamp": {
            "type": "string",
            "title": "Timestamp"
          },
          "message_id": {
            "type": "string",
            "title": "Message Id"
          }
        },
        "type": "object",
        "required": [
          "from_address",
          "content",
          "timestamp",
          "message_id"
        ],
        "title": "DemoMessage"
      },
      "DemoSendRequest": {
        "properties": {
          "session_id": {
            "type": "string",
            "title": "Session Id"
          },
          "to_address": {
            "type": "string",
            "title": "To Address"
          },
          "message": {
            "type": "string",
            "title": "Message"
          }
        },
        "type": "object",
        "required": [
          "session_id",
          "to_address",
          "message"
        ],
        "title": "DemoSendRequest"
      },
      "DemoSendResponse": {
        "properties": {
          "message_id": {
            "type": "string",
            "title": "Message Id"
          }
        },
        "type": "object",
        "required": [
          "message_id"
        ],
        "title": "DemoSendResponse"
      },
      "FederationDeliverRequest": {
        "properties": {
          "envelope": {
            "additionalProperties": true,
            "type": "object",
            "title": "Envelope"
          },
          "via": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Via",
            "default": []
          },
          "hop_count": {
            "type": "integer",
            "title": "Hop Count",
            "default": 0
          },
          "timestamp": {
            "type": "string",
            "title": "Timestamp"
          },
          "from_relay": {
            "type": "string",
            "title": "From Relay"
          }
        },
        "type": "object",
        "required": [
          "envelope",
          "timestamp",
          "from_relay"
        ],
        "title": "FederationDeliverRequest"
      },
      "FederationDeliverResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "detail": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Detail"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "FederationDeliverResponse"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HandshakeListResponse": {
        "properties": {
          "handshakes": {
            "items": {
              "$ref": "#/components/schemas/HandshakeResponse"
            },
            "type": "array",
            "title": "Handshakes"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "handshakes",
          "count"
        ],
        "title": "HandshakeListResponse"
      },
      "HandshakeRespondRequest": {
        "properties": {
          "response": {
            "type": "string",
            "title": "Response"
          }
        },
        "type": "object",
        "required": [
          "response"
        ],
        "title": "HandshakeRespondRequest"
      },
      "HandshakeResponse": {
        "properties": {
          "id": {
            "type": "integer",
            "title": "Id"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "from_addr": {
            "type": "string",
            "title": "From Addr"
          },
          "to_addr": {
            "type": "string",
            "title": "To Addr"
          }
        },
        "type": "object",
        "required": [
          "id",
          "status",
          "from_addr",
          "to_addr"
        ],
        "title": "HandshakeResponse"
      },
      "HandshakeSendRequest": {
        "properties": {
          "to_address": {
            "type": "string",
            "title": "To Address"
          },
          "contact_card": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Contact Card"
          }
        },
        "type": "object",
        "required": [
          "to_address"
        ],
        "title": "HandshakeSendRequest"
      },
      "HealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "agents_online": {
            "type": "integer",
            "title": "Agents Online"
          },
          "version": {
            "type": "string",
            "title": "Version"
          }
        },
        "type": "object",
        "required": [
          "status",
          "agents_online",
          "version"
        ],
        "title": "HealthResponse"
      },
      "InboxResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "messages": {
            "items": {
              "additionalProperties": true,
              "type": "object"
            },
            "type": "array",
            "title": "Messages"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "address",
          "messages",
          "count"
        ],
        "title": "InboxResponse"
      },
      "PresenceResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "online": {
            "type": "boolean",
            "title": "Online"
          },
          "last_seen": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Seen"
          }
        },
        "type": "object",
        "required": [
          "address",
          "online"
        ],
        "title": "PresenceResponse"
      },
      "PublicKeyResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "public_key": {
            "type": "string",
            "title": "Public Key"
          },
          "tier": {
            "type": "integer",
            "title": "Tier",
            "default": 1
          },
          "verified_domain": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Verified Domain"
          }
        },
        "type": "object",
        "required": [
          "address",
          "public_key"
        ],
        "title": "PublicKeyResponse"
      },
      "PurgeExpiredResponse": {
        "properties": {
          "purged": {
            "type": "integer",
            "title": "Purged"
          }
        },
        "type": "object",
        "required": [
          "purged"
        ],
        "title": "PurgeExpiredResponse"
      },
      "ReceiptRequest": {
        "properties": {
          "type": {
            "type": "string",
            "title": "Type"
          },
          "timestamp": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Timestamp"
          }
        },
        "type": "object",
        "required": [
          "type"
        ],
        "title": "ReceiptRequest"
      },
      "ReceiptResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "message_id": {
            "type": "string",
            "title": "Message Id"
          }
        },
        "type": "object",
        "required": [
          "status",
          "message_id"
        ],
        "title": "ReceiptResponse"
      },
      "RegisterRequest": {
        "properties": {
          "agent_name": {
            "type": "string",
            "title": "Agent Name"
          },
          "public_key": {
            "type": "string",
            "title": "Public Key"
          },
          "webhook_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Webhook Url"
          }
        },
        "type": "object",
        "required": [
          "agent_name",
          "public_key"
        ],
        "title": "RegisterRequest"
      },
      "RegisterResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "token": {
            "type": "string",
            "title": "Token"
          },
          "relay": {
            "type": "string",
            "title": "Relay"
          }
        },
        "type": "object",
        "required": [
          "address",
          "token",
          "relay"
        ],
        "title": "RegisterResponse"
      },
      "ReputationResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "score": {
            "type": "integer",
            "title": "Score"
          },
          "tier": {
            "type": "string",
            "title": "Tier"
          },
          "messages_sent": {
            "type": "integer",
            "title": "Messages Sent"
          },
          "messages_rejected": {
            "type": "integer",
            "title": "Messages Rejected"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "title": "Updated At"
          }
        },
        "type": "object",
        "required": [
          "address",
          "score",
          "tier",
          "messages_sent",
          "messages_rejected",
          "created_at",
          "updated_at"
        ],
        "title": "ReputationResponse"
      },
      "SendRequest": {
        "properties": {
          "envelope": {
            "additionalProperties": true,
            "type": "object",
            "title": "Envelope"
          }
        },
        "type": "object",
        "required": [
          "envelope"
        ],
        "title": "SendRequest"
      },
      "SendResponse": {
        "properties": {
          "message_id": {
            "type": "string",
            "title": "Message Id"
          },
          "delivered": {
            "type": "boolean",
            "title": "Delivered"
          }
        },
        "type": "object",
        "required": [
          "message_id",
          "delivered"
        ],
        "title": "SendResponse"
      },
      "SetReputationRequest": {
        "properties": {
          "score": {
            "type": "integer",
            "title": "Score"
          }
        },
        "type": "object",
        "required": [
          "score"
        ],
        "title": "SetReputationRequest"
      },
      "ThreadResponse": {
        "properties": {
          "thread_id": {
            "type": "string",
            "title": "Thread Id"
          },
          "messages": {
            "items": {
              "additionalProperties": true,
              "type": "object"
            },
            "type": "array",
            "title": "Messages"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "thread_id",
          "messages",
          "count"
        ],
        "title": "ThreadResponse"
      },
      "UpdateAgentRequest": {
        "properties": {
          "display_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Display Name"
          },
          "contact_card": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Contact Card"
          },
          "public_key": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Public Key"
          }
        },
        "type": "object",
        "title": "UpdateAgentRequest"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          },
          "input": {
            "title": "Input"
          },
          "ctx": {
            "type": "object",
            "title": "Context"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "VerifyDomainRequest": {
        "properties": {
          "domain": {
            "type": "string",
            "title": "Domain"
          }
        },
        "type": "object",
        "required": [
          "domain"
        ],
        "title": "VerifyDomainRequest"
      },
      "VerifyDomainResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status"
          },
          "domain": {
            "type": "string",
            "title": "Domain"
          },
          "tier": {
            "type": "integer",
            "title": "Tier"
          },
          "detail": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Detail"
          }
        },
        "type": "object",
        "required": [
          "status",
          "domain",
          "tier"
        ],
        "title": "VerifyDomainResponse"
      },
      "WebhookDeliveryListResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "deliveries": {
            "items": {
              "$ref": "#/components/schemas/WebhookDeliveryRecord"
            },
            "type": "array",
            "title": "Deliveries"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "address",
          "deliveries",
          "count"
        ],
        "title": "WebhookDeliveryListResponse"
      },
      "WebhookDeliveryRecord": {
        "properties": {
          "id": {
            "type": "integer",
            "title": "Id"
          },
          "message_id": {
            "type": "string",
            "title": "Message Id"
          },
          "status": {
            "type": "string",
            "title": "Status"
          },
          "attempt_count": {
            "type": "integer",
            "title": "Attempt Count"
          },
          "last_status_code": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Status Code"
          },
          "last_error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Error"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          },
          "completed_at": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Completed At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "message_id",
          "status",
          "attempt_count",
          "created_at"
        ],
        "title": "WebhookDeliveryRecord"
      },
      "WebhookUrlRequest": {
        "properties": {
          "webhook_url": {
            "type": "string",
            "title": "Webhook Url"
          }
        },
        "type": "object",
        "required": [
          "webhook_url"
        ],
        "title": "WebhookUrlRequest"
      },
      "WebhookUrlResponse": {
        "properties": {
          "address": {
            "type": "string",
            "title": "Address"
          },
          "webhook_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Webhook Url"
          }
        },
        "type": "object",
        "required": [
          "address",
          "webhook_url"
        ],
        "title": "WebhookUrlResponse"
      },
      "WellKnownRelayResponse": {
        "properties": {
          "relay_domain": {
            "type": "string",
            "title": "Relay Domain"
          },
          "federation_endpoint": {
            "type": "string",
            "title": "Federation Endpoint"
          },
          "public_key": {
            "type": "string",
            "title": "Public Key"
          },
          "version": {
            "type": "string",
            "title": "Version",
            "default": "0.1"
          }
        },
        "type": "object",
        "required": [
          "relay_domain",
          "federation_endpoint",
          "public_key"
        ],
        "title": "WellKnownRelayResponse"
      }
    },
    "securitySchemes": {
      "HTTPBearer": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  }
}